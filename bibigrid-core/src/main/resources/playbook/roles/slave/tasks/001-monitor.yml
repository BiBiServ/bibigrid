- name: Install Ganglia
  apt:
    name: ganglia-monitor
    state: present
  tags: ["slave-ganglia-install"]

- name: Configure Ganglia
  template:
    src: ganglia/gmond.conf.j2
    dest: /etc/ganglia/gmond.conf
    owner: root
    group: root
    mode: 0644
  register: gmonf_conf
  tags: ["slave-ganglia-configure"]

- name: Restart Ganglia 
  systemd:
    name: ganglia-monitor
    state: restarted
    enabled: yes
  when: gmonf_conf is changed
  tags: ["slave-ganglia-restart"]
